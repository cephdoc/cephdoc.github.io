
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>贡献 Ceph 文档 &mdash; Ceph Documentation</title>
    
    <link rel="stylesheet" href="../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     'dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="Ceph Documentation" href="../../" />
    <link rel="up" title="Ceph 简介" href="../intro/" />
    <link rel="next" title="安装（快速）" href="../" />
    <link rel="prev" title="加入 Ceph 社区！" href="../get-involved/" />
    <script type="text/javascript" src="http://ayni.ceph.com/public/js/ceph.js"></script>

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex/" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../" title="安装（快速）"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../get-involved/" title="加入 Ceph 社区！"
             accesskey="P">previous</a> |</li>
        <li><a href="../../">Ceph Documentation</a> &raquo;</li>
          <li><a href="../intro/" accesskey="U">Ceph 简介</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="ceph">
<h1>贡献 Ceph 文档<a class="headerlink" href="#ceph" title="Permalink to this headline">¶</a></h1>
<p>帮助 Ceph 项目的<strong>最简单的方法</strong>之一就是贡献文档，随着 Ceph 用户量的增长和开发的迅速推进，越来越多的人在更新文档、增加新条目。即使是修正拼写错误或增加说明这样的小贡献也会提升 Ceph 项目的品质。</p>
<p>Ceph 文档源码位于 Ceph 源码库的 <tt class="docutils literal"><span class="pre">ceph/doc</span></tt> 目录下，由 Python Sphinx 渲染成 HTML 和手册页。 <a class="reference external" href="http://ceph.com/docs">http://ceph.com/docs</a> 链接默认展示 <tt class="docutils literal"><span class="pre">master</span></tt> 分支，也可以查看较早分支（如 <tt class="docutils literal"><span class="pre">argonaut</span></tt> ）或者未来分支（如 <tt class="docutils literal"><span class="pre">next</span></tt> ）的文档，同样可以查看正在改进的分支，只需把 <tt class="docutils literal"><span class="pre">master</span></tt> 改成你想看的分支即可。</p>
<div class="section" id="id1">
<h2>如何贡献<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>贡献文档和贡献源码的过程基本相同，唯一不同的就是你编译的是文档源码而不是程序源码。大致顺序如下：</p>
<ol class="arabic simple">
<li><a class="reference internal" href="#id2">获取源代码</a></li>
<li><a class="reference internal" href="#id3">进入分支</a></li>
<li><a class="reference internal" href="#id4">开始更改</a></li>
<li><a class="reference internal" href="#id5">构建文档源码</a></li>
<li><a class="reference internal" href="#id7">提交变更</a></li>
<li><a class="reference internal" href="#id8">推送变更</a></li>
<li><a class="reference internal" href="#id9">发出接收请求</a></li>
<li><a class="reference internal" href="#id10">通知相关人员</a></li>
</ol>
<div class="section" id="id2">
<h3>获取源代码<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>Ceph 文档位于和源码同一仓库内的 <tt class="docutils literal"><span class="pre">ceph/doc</span></tt> 目录下，关于 github 和 Ceph 的详细情况见<a class="reference internal" href="../get-involved/#get-involved"><em>加入 Ceph 社区！</em></a>。</p>
<p>最常用的贡献方法是<a class="reference external" href="https://help.github.com/articles/using-pull-requests">分支并拉入</a>。为此，必须先做到：</p>
<ol class="arabic">
<li><p class="first">在本地安装 git 。在 Debian/Ubuntu 下用此命令：</p>
<div class="highlight-python"><pre>sudo apt-get install git</pre>
</div>
<p>在 Fedora 下用此命令：</p>
<div class="highlight-python"><pre>sudo yum install git</pre>
</div>
<p>在 CentOS/RHEL 下用此命令：</p>
<div class="highlight-python"><pre>sudo yum install git</pre>
</div>
</li>
<li><p class="first">在 <tt class="docutils literal"><span class="pre">.gitconfig</span></tt> 配置文件里写好自己的名字和邮件地址。</p>
<div class="highlight-python"><pre>[user]
   email = {your-email-address}
   name = {your-name}</pre>
</div>
<p>例如：</p>
<div class="highlight-python"><pre>git config --global user.name "John Doe"
git config --global user.email johndoe@example.com</pre>
</div>
</li>
<li><p class="first">创建 <a class="reference external" href="http://github.com">github</a> 帐户（假如没有的话）。</p>
</li>
<li><p class="first">创建 Ceph 项目的分支，参见 <a class="reference external" href="https://github.com/ceph/ceph">https://github.com/ceph/ceph</a> 。</p>
</li>
<li><p class="first">把已分支项目克隆到本机。</p>
</li>
</ol>
<p>Ceph 文档按主要组件来分类组织。</p>
<ul class="simple">
<li><strong>Ceph 存储集群：</strong>Ceph 存储集群文档位于 <tt class="docutils literal"><span class="pre">doc/rados</span></tt> 目录下；</li>
<li><strong>Ceph 块设备：</strong>Ceph 块设备文档位于 <tt class="docutils literal"><span class="pre">doc/rbd</span></tt> 目录下；</li>
<li><strong>Ceph 对象存储：</strong>Ceph 对象存储文档位于 <tt class="docutils literal"><span class="pre">doc/radosgw</span></tt> 目录下；</li>
<li><strong>Ceph 文件系统：</strong>Ceph 文件系统文档位于 <tt class="docutils literal"><span class="pre">doc/cephfs</span></tt> 目录下；</li>
<li><strong>安装（快速）：</strong>快速入门文档位于 <tt class="docutils literal"><span class="pre">doc/start</span></tt> 目录下；</li>
<li><strong>安装（手动）：</strong>手动安装文档位于 <tt class="docutils literal"><span class="pre">doc/install</span></tt> 目录下；</li>
<li><strong>手册页：</strong>手册源码位于 <tt class="docutils literal"><span class="pre">doc/man</span></tt> 目录下；</li>
<li><strong>开发者：</strong>开发者文档位于 <tt class="docutils literal"><span class="pre">doc/dev</span></tt> 目录下；</li>
<li><strong>图片：</strong>如果你想上传文档，如 JPEG 或 PNG 文件，应该放到 <tt class="docutils literal"><span class="pre">doc/images</span></tt> 目录下。</li>
</ul>
</div>
<div class="section" id="id3">
<h3>进入分支<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>如果只是细小的变更，像修正排版错误、或换一种措辞，直接提交到 <tt class="docutils literal"><span class="pre">master</span></tt> 分支即可；为当前版本的功能提供文档时也应该提交到 <tt class="docutils literal"><span class="pre">master</span></tt> 分支。 <tt class="docutils literal"><span class="pre">master</span></tt> 是最常用的分支。</p>
<div class="highlight-python"><pre>git checkout master</pre>
</div>
<p>给未来版本提供文档时应该提交到 <tt class="docutils literal"><span class="pre">next</span></tt> 分支， <tt class="docutils literal"><span class="pre">next</span></tt> 分支是第二常用的分支。</p>
<div class="highlight-python"><pre>git checkout next</pre>
</div>
<p>你在为尚未发布的功能写文档时，如果这部分文档和已追踪的某个问题有关，或者想在它被合并到 <tt class="docutils literal"><span class="pre">master</span></tt> 分支前看看它在 ceph.com 网站上的预览，你应该另外创建个分支。为标识这是个只包含文档的更新，按惯例用 <tt class="docutils literal"><span class="pre">wip-doc</span></tt> 作前缀，按这个格式 <tt class="docutils literal"><span class="pre">wip-doc-{your-branch-name}</span></tt> 。如果此分支和 <a class="reference external" href="http://tracker.ceph.com/issues">http://tracker.ceph.com/issues</a> 里的某个问题相关，分支名最好包含问题编号，例如，如果某文档分支是为 #4000 这个问题写的，按惯例这个分支名就是 <tt class="docutils literal"><span class="pre">wip-doc-4000</span></tt> ，对应的问题追踪 URL 就是 <a class="reference external" href="http://tracker.ceph.com/issues/4000">http://tracker.ceph.com/issues/4000</a> 。</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">请不要把贡献的文档和源码混合到同一个 pull 请求里，因为文档由编辑审阅、而源码由工程师审阅。您分别提交文档和源码时，合并进度会很快，我们也不用让您重新提交。</p>
</div>
<p>创建分支前，确保本地和远程都没有同名的。</p>
<div class="highlight-python"><pre>git branch -a | grep wip-doc-{your-branch-name}</pre>
</div>
<p>如果确实不存在，就可以创建了：</p>
<div class="highlight-python"><pre>git checkout -b wip-doc-{your-branch-name}</pre>
</div>
</div>
<div class="section" id="id4">
<h3>开始更改<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>修改文档很简单，打开 restructuredText 文件、修改、保存即可。相关的语法请参考 <a class="reference internal" href="#id11">文档风格手册</a> 。</p>
<p>新增文档要在 <tt class="docutils literal"><span class="pre">doc</span></tt> 目录或其子目录下新建 restructuredText 文件，并以 <tt class="docutils literal"><span class="pre">*.rst</span></tt> 作后缀。还必须包含对它的引用：如超链接或目录条目。某个顶极目录中的 <tt class="docutils literal"><span class="pre">index.rst</span></tt> 文件通常也包含一个 TOC ，你可以在这里添加新文件名。所有文档都必须有标题，详情见<a class="reference internal" href="#id12">标题</a>。</p>
<p>你新建的文档不会自动被 <tt class="docutils literal"><span class="pre">git</span></tt> 跟踪，如果想把它加进仓库，必须用 <tt class="docutils literal"><span class="pre">git</span> <span class="pre">add</span> <span class="pre">{path-to-filename}</span></tt> 命令。比如，在 Ceph 仓库的顶极目录下，把 <tt class="docutils literal"><span class="pre">example.rst</span></tt> 文件加到 <tt class="docutils literal"><span class="pre">rados</span></tt> 子目录下，可以这样：</p>
<div class="highlight-python"><pre>git add doc/rados/example.rst</pre>
</div>
<p>要删除一文档，应该用 <tt class="docutils literal"><span class="pre">git</span> <span class="pre">rm</span> <span class="pre">{path-to-filename}</span></tt> ，比如：</p>
<div class="highlight-python"><pre>git rm doc/rados/example.rst</pre>
</div>
<p>还必须从其他文档删除与之相关的引用。</p>
</div>
<div class="section" id="id5">
<h3>构建文档源码<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p>要想构建文档，先进入 <tt class="docutils literal"><span class="pre">ceph</span></tt> 库目录：</p>
<div class="highlight-python"><pre>cd ceph</pre>
</div>
<p>在 Debian/Ubuntu 上执行此命令构建文档：</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">admin</span><span class="o">/</span><span class="n">build</span><span class="o">-</span><span class="n">doc</span>
</pre></div>
</div>
<p>在 Fedora 上执行此命令构建文档：</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">admin</span><span class="o">/</span><span class="n">build</span><span class="o">-</span><span class="n">doc</span>
</pre></div>
</div>
<p>在 CentOS/RHEL 上执行此命令构建文档：</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">admin</span><span class="o">/</span><span class="n">build</span><span class="o">-</span><span class="n">doc</span>
</pre></div>
</div>
<p>执行 <tt class="docutils literal"><span class="pre">admin/build-doc</span></tt> 之后，它会在 <tt class="docutils literal"><span class="pre">ceph</span></tt> 下创建一个 <tt class="docutils literal"><span class="pre">build-doc</span></tt> 目录。你也许还得在 <tt class="docutils literal"><span class="pre">ceph/build-doc</span></tt> 下创建个目录用于 Javadoc 的输出。</p>
<div class="highlight-python"><pre>mkdir -p output/html/api/libcephfs-java/javadoc</pre>
</div>
<p><tt class="docutils literal"><span class="pre">build-doc</span></tt> 构建脚本可能会产生警告和报错，有关语法的错误<strong>必须</strong>修复才能提交，警告<strong>应该</strong>尽量消除。</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">你必须核实<strong>所有超链接</strong>，损坏的超链接会中止构建过程。</p>
</div>
<p>文档构建完成后你就可以到源码目录下查看了：</p>
<div class="highlight-python"><pre>cd build-doc/output</pre>
</div>
<p>那里应该有 <tt class="docutils literal"><span class="pre">html</span></tt> 目录和 <tt class="docutils literal"><span class="pre">man</span></tt> 目录分别存放着 HTML 和手册页格式的文档。</p>
<div class="section" id="id6">
<h4>构建源码（首次）<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h4>
<p>Ceph 用 Python Sphinx 构建文档，此软件一般都没安装。首次构建文档时，它会生成一个用于 doxygen 的 XML 树，这个过程比较耗时.</p>
<p>Python Sphinx 的依赖软件包根据发行版不同而有所区别。首次构建文档时，如果你没安装必要工具，构建脚本会提示你。要运行 Sphinx 并成功构建文档，至少要安装下面这些软件包：</p>
<style type="text/css">div.body h3{margin:5px 0px 0px 0px;}</style>
<table cellpadding="10"><colgroup><col width="30%"><col width="30%"><col width="30%"></colgroup><tbody valign="top"><tr><td><h3>Debian/Ubuntu</h3><ul class="simple">
<li>gcc</li>
<li>python-dev</li>
<li>python-pip</li>
<li>python-virtualenv</li>
<li>python-sphinx</li>
<li>libxml2-dev</li>
<li>libxslt1-dev</li>
<li>doxygen</li>
<li>graphviz</li>
<li>ant</li>
<li>ditaa</li>
</ul>
</td><td><h3>Fedora</h3><ul class="simple">
<li>gcc</li>
<li>python-devel</li>
<li>python-pip</li>
<li>python-virtualenv</li>
<li>python-docutils</li>
<li>python-jinja2</li>
<li>python-pygments</li>
<li>python-sphinx</li>
<li>libxml2-devel</li>
<li>libxslt1-devel</li>
<li>doxygen</li>
<li>graphviz</li>
<li>ant</li>
<li>ditaa</li>
</ul>
</td><td><h3>CentOS/RHEL</h3><ul class="simple">
<li>gcc</li>
<li>python-devel</li>
<li>python-pip</li>
<li>python-virtualenv</li>
<li>python-docutils</li>
<li>python-jinja2</li>
<li>python-pygments</li>
<li>python-sphinx</li>
<li>libxml2-dev</li>
<li>libxslt1-dev</li>
<li>doxygen</li>
<li>graphviz</li>
<li>ant</li>
</ul>
</td></tr></tbody></table><p>缺少的依赖都要安装，基于 Debian/Ubuntu 发行版的系统可以用此命令安装：</p>
<div class="highlight-python"><pre>sudo apt-get install gcc python-dev python-pip python-virtualenv libxml2-dev libxslt-dev doxygen graphviz ant ditaa
sudo apt-get install python-sphinx</pre>
</div>
<p>在 Fedora 发行版上可以执行：</p>
<div class="highlight-python"><pre>sudo yum install gcc python-devel python-pip python-virtualenv libxml2-devel libxslt-devel doxygen graphviz ant
sudo pip install html2text
sudo yum install python-jinja2 python-pygments python-docutils python-sphinx
sudo yum install jericho-html ditaa</pre>
</div>
<p>在 CentOS/RHEL 发行版上，最好安装 <tt class="docutils literal"><span class="pre">epel</span></tt> (Extra Packages for Enterprise Linux) 软件库，因为它提供了很多默认软件库所没有的软件包。可执行此命令安装 <tt class="docutils literal"><span class="pre">epel</span></tt> ：</p>
<div class="highlight-python"><pre>wget http://ftp.riken.jp/Linux/fedora/epel/7/x86_64/e/epel-release-7-2.noarch.rpm
sudo yum install epel-release-7-2.noarch.rpm</pre>
</div>
<p>在 CentOS/RHEL 发行版上可以执行：</p>
<div class="highlight-python"><pre>sudo yum install gcc python-devel python-pip python-virtualenv libxml2-devel libxslt-devel doxygen graphviz ant
sudo pip install html2text</pre>
</div>
<p>对于 CentOS/RHEL 发行版，其余软件包不包含在默认及 <tt class="docutils literal"><span class="pre">epel</span></tt> 软件库内，所以得到 <a class="reference external" href="http://rpmfind.net/">http://rpmfind.net/</a> 找，然后到合适的镜像下载并安装它们，比如：</p>
<div class="highlight-python"><pre>wget ftp://rpmfind.net/linux/centos/7.0.1406/os/x86_64/Packages/python-jinja2-2.7.2-2.el7.noarch.rpm
sudo yum install python-jinja2-2.7.2-2.el7.noarch.rpm
wget ftp://rpmfind.net/linux/centos/7.0.1406/os/x86_64/Packages/python-pygments-1.4-9.el7.noarch.rpm
sudo yum install python-pygments-1.4-9.el7.noarch.rpm
wget ftp://rpmfind.net/linux/centos/7.0.1406/os/x86_64/Packages/python-docutils-0.11-0.2.20130715svn7687.el7.noarch.rpm
sudo yum install python-docutils-0.11-0.2.20130715svn7687.el7.noarch.rpm
wget ftp://rpmfind.net/linux/centos/7.0.1406/os/x86_64/Packages/python-sphinx-1.1.3-8.el7.noarch.rpm
sudo yum install python-sphinx-1.1.3-8.el7.noarch.rpm</pre>
</div>
<p>Ceph 文档大量使用了 <a class="reference external" href="http://ditaa.sourceforge.net/">ditaa</a> ，它没有对应的 CentOS/RHEL7 二进制包。如果你要修改 <a class="reference external" href="http://ditaa.sourceforge.net/">ditaa</a> 图，那你必须安装 <a class="reference external" href="http://ditaa.sourceforge.net/">ditaa</a> 才能确认你新增或修改的 <a class="reference external" href="http://ditaa.sourceforge.net/">ditaa</a> 图可以正确渲染。你可以自己去找与 CentOS/RHEL7 发行版兼容的包，并手动安装。在 CentOS/RHEL7 下 <a class="reference external" href="http://ditaa.sourceforge.net/">ditaa</a> 依赖下列软件包：</p>
<ul class="simple">
<li>jericho-html</li>
<li>jai-imageio-core</li>
<li>batik</li>
</ul>
<p>到 <a class="reference external" href="http://rpmfind.net/">http://rpmfind.net/</a> 找兼容的 <tt class="docutils literal"><span class="pre">ditaa</span></tt> 及其依赖，然后从某个镜像下载并安装它们。例如：</p>
<div class="highlight-python"><pre>wget ftp://rpmfind.net/linux/fedora/linux/releases/20/Everything/x86_64/os/Packages/j/jericho-html-3.2-6.fc20.noarch.rpm
sudo yum install jericho-html-3.2-6.fc20.noarch.rpm
wget ftp://rpmfind.net/linux/centos/7.0.1406/os/x86_64/Packages/jai-imageio-core-1.2-0.14.20100217cvs.el7.noarch.rpm
sudo yum install jai-imageio-core-1.2-0.14.20100217cvs.el7.noarch.rpm
wget ftp://rpmfind.net/linux/centos/7.0.1406/os/x86_64/Packages/batik-1.8-0.12.svn1230816.el7.noarch.rpm
sudo yum install batik-1.8-0.12.svn1230816.el7.noarch.rpm
wget ftp://rpmfind.net/linux/fedora/linux/releases/20/Everything/x86_64/os/Packages/d/ditaa-0.9-10.r74.fc20.noarch.rpm
sudo yum install ditaa-0.9-10.r74.fc20.noarch.rpm</pre>
</div>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">不要安装含 <tt class="docutils literal"><span class="pre">fc21</span></tt> 的 <tt class="docutils literal"><span class="pre">ditaa</span></tt> rpm包，因为它使用的 <tt class="docutils literal"><span class="pre">JRE</span></tt> 比 CentOS/RHEL7 自带的新，这样会导致冲突并抛出异常 <tt class="docutils literal"><span class="pre">Exception</span></tt> ，程序也因此不能运行。</p>
</div>
<p>安装好所有这些包之后，就可以按照<tt class="docutils literal"><span class="pre">构建文档源码</span></tt>里的步骤构建文档了。</p>
</div>
</div>
<div class="section" id="id7">
<h3>提交变更<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<p>Ceph文档的提交虽然简单，却遵循着严格的惯例：</p>
<ul class="simple">
<li>一次提交<strong>应该</strong>只涉及一个文件（方便回退），也<strong>可以</strong>一次提交有关联的多个文件。不相干的变更<strong>不应该</strong>放到同一提交内；</li>
<li>每个提交都<strong>必须</strong>有注释；</li>
<li>提交的注释<strong>必须</strong>以 <tt class="docutils literal"><span class="pre">doc:</span></tt> 打头（应严格遵守）；</li>
<li>注释摘要<strong>必须</strong>只有一行（应严格遵守）；</li>
<li>额外的注释<strong>可以</strong>写到摘要下面空一行的地方，但应该简单明了；</li>
<li>提交<strong>可以</strong>包含 <tt class="docutils literal"><span class="pre">Fixes:</span> <span class="pre">#{bug</span> <span class="pre">number}</span></tt> 字样；</li>
<li>提交<strong>必须</strong>包含 <tt class="docutils literal"><span class="pre">Signed-off-by:</span> <span class="pre">Firstname</span> <span class="pre">Lasname</span> <span class="pre">&lt;email&gt;</span></tt> （应严格遵守）。</li>
</ul>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">请遵守前述惯例，特别是标明了 <tt class="docutils literal"><span class="pre">（应严格遵守）</span></tt> 的那些，否则你的提交会被打回，修正后才能重新提交。</p>
</div>
<p>下面是个通用提交的注释（首选）：</p>
<div class="highlight-python"><pre>doc: Fixes a spelling error and a broken hyperlink.

Signed-off-by: John Doe &lt;john.doe@gmail.com&gt;</pre>
</div>
<p>下面的注释里有到 BUG 的引用。</p>
<div class="highlight-python"><pre>doc: Fixes a spelling error and a broken hyperlink.

Fixes: #1234

Signed-off-by: John Doe &lt;john.doe@gmail.com&gt;</pre>
</div>
<p>下面的注释包含一句概要和详述，在摘要和详述之间用空行隔开了：</p>
<div class="highlight-python"><pre>doc: Added mon setting to monitor config reference

Describes 'mon setting', which is a new setting added
to config_opts.h.

Signed-off-by: John Doe &lt;john.doe@gmail.com&gt;</pre>
</div>
<p>执行下列命令提交变更：</p>
<div class="highlight-python"><pre>git commit -a</pre>
</div>
<p>管理文档提交的一个比较简单的方法是用 <tt class="docutils literal"><span class="pre">git</span></tt> 的图形化前端，如 <tt class="docutils literal"><span class="pre">gitk</span></tt> 提供了可查看仓库历史的图形界面； <tt class="docutils literal"><span class="pre">git-gui</span></tt> 提供的图形界面可查看未提交的变更、把未提交变更暂存起来、提交变更、并推送到自己的 Ceph 分支仓库。</p>
<p>在 Debian/Ubuntu 上执行以下命令安装：</p>
<div class="highlight-python"><pre>sudo apt-get install gitk git-gui</pre>
</div>
<p>在 Fedora/CentOS/RHEL 上执行以下命令安装：</p>
<div class="highlight-python"><pre>sudo yum install gitk git-gui</pre>
</div>
<p>然后执行</p>
<div class="highlight-python"><pre>cd {git-ceph-repo-path}
gitk</pre>
</div>
<p>最后，点击 <strong>File-&gt;Start git gui</strong> 打开图形界面。</p>
</div>
<div class="section" id="id8">
<h3>推送变更<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<p>你完成一或多个提交后，必须从本地推送到位于 <tt class="docutils literal"><span class="pre">github</span></tt> 的仓库。某些图形化工具（如 <tt class="docutils literal"><span class="pre">git-gui</span></tt> ）有推送菜单。如果你之前创建了分支：</p>
<div class="highlight-python"><pre>git push origin wip-doc-{your-branch-name}</pre>
</div>
<p>否则：</p>
<div class="highlight-python"><pre>git push</pre>
</div>
</div>
<div class="section" id="id9">
<h3>发出接收请求<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<p>前面已经说过了，你可以依照<a class="reference external" href="https://help.github.com/articles/using-pull-requests">分支并拉入</a>方法共享文档。</p>
</div>
<div class="section" id="id10">
<h3>通知相关人员<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h3>
<p>发出接收请求后，还需通知相关人员。通常，文档的接收请求应该发给 <a class="reference external" href="mailto:jowilkin&#37;&#52;&#48;redhat&#46;com">John Wilkins</a> 。</p>
</div>
</div>
<div class="section" id="id11">
<h2>文档风格手册<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h2>
<p>Ceph 文档项目的目标之一就是可读性，包括 restructuredText 和渲染后的 HTML 页面的可读性。进入 Ceph 源码库，随便找个文档查看其源码，你会发现它们在终端下就像已经渲染过的 HTML 页面一样清晰明了。另外，也许你还看到 <tt class="docutils literal"><span class="pre">ditaa</span></tt> 格式的图表渲染的很漂亮。</p>
<div class="highlight-python"><pre>cat doc/architecture.rst | less</pre>
</div>
<p>为了维持一致性，请遵守下面的风格手册。</p>
<div class="section" id="id12">
<h3>标题<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li><strong>文档标题：</strong> 标题行的前/后各加一行 <tt class="docutils literal"><span class="pre">=</span></tt> ，且标题行首、行尾各有一个空格，详情见<a class="reference external" href="http://docutils.sourceforge.net/docs/user/rst/quickstart.html#document-title-subtitle">文档标题</a>。</li>
<li><strong>段落标题：</strong> 段标题行下是一行 <tt class="docutils literal"><span class="pre">=</span></tt> ，且标题行首、行尾都没有空格；段标题前应该有两个空行（除非前面是内嵌引用）。详情见<a class="reference external" href="http://docutils.sourceforge.net/docs/user/rst/quickstart.html#sections">小节</a>。</li>
<li><strong>小节标题：</strong> 小节标题行下是一行 <tt class="docutils literal"><span class="pre">-</span></tt> ，且行首、行尾都没有空格；段标题前应该有两个空行（除非前面是内嵌引用）。</li>
</ol>
</div>
<div class="section" id="id13">
<h3>正文<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h3>
<p>通常，我们把正文限制在 80 列之内，这样它在任何标准终端内都可以正确显示，行首、行尾都不能有空格。我们应该尽可能维持此惯例，包括文本、项目、文字文本（允许例外）、表格、和 <tt class="docutils literal"><span class="pre">ditaa</span></tt> 图形。</p>
<ol class="arabic">
<li><p class="first"><strong>段落：</strong> 段落前后各有一空行，且宽度不超过 80 字符，这样文档源码就可以在任何标准终端正确显示。</p>
</li>
<li><p class="first"><strong>引文文本：</strong> 要创建引文文本（如展示命令行用法），前一段应以 <tt class="docutils literal"><span class="pre">::</span></tt> 结尾；或者先加一个空行、然后在新行上输入 <tt class="docutils literal"><span class="pre">::</span></tt> 、之后再加一个空行。之后以 TAB （首选）或 3 个空格缩进，开始输入引文了。</p>
</li>
<li><p class="first"><strong>缩进文本：</strong> 像要点这样的缩进文本（如： <tt class="docutils literal"><span class="pre">-</span> <span class="pre">some</span> <span class="pre">text</span></tt> ）可能会延伸很多行，后续行应该延续和首行缩进（数字、圆点等）相同的起始列。</p>
<p>缩进文本也可以包含引文。这时，缩进文本仍然用空格标记、引文仍用 TAB 标记。按照这个惯例，你就可以额外增加缩进段落，并在其中嵌入引文示例（引文段前加空行，行前用空格缩进）。</p>
</li>
<li><p class="first"><strong>编号项目：</strong> 需编号的列表应该在行首用 <tt class="docutils literal"><span class="pre">#</span></tt> 标识以实现自动编号，而不是手动标识，这样在条目顺序变更时就不用重新编号了。</p>
</li>
<li><p class="first"><strong>代码示例：</strong> Ceph 文档中可以用 <tt class="docutils literal"><span class="pre">..</span> <span class="pre">code-block::&lt;language&gt;</span></tt> 按语种对源码进行高亮显示，对源代码应该这样标记。然而，使用这个标签时将导致编号项目从 1 开始重新编号，详情见<a class="reference external" href="http://sphinx-doc.org/markup/code.html">显示代码示例</a>。</p>
</li>
</ol>
</div>
<div class="section" id="id14">
<h3>段落分级标记<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h3>
<p>Ceph 文档项目用<a class="reference internal" href="#id14">段落分级标记</a>来高亮显示要点。</p>
<ol class="arabic simple">
<li><strong>Tip:</strong> 提示：用 <tt class="docutils literal"><span class="pre">..</span> <span class="pre">tip::</span></tt> 指令标识额外信息，以助读者或操作员脱困。</li>
<li><strong>Note:</strong> 注：用 <tt class="docutils literal"><span class="pre">..</span> <span class="pre">note::</span></tt> 指令来高亮显示一个要点。</li>
<li><strong>Important:</strong> 重要：用 <tt class="docutils literal"><span class="pre">..</span> <span class="pre">important::</span></tt> 指令来高亮显示重要依赖或警告（如可能导致数据丢失的事情）。尽量少用，因为它会渲染成红色背景。</li>
<li><strong>Version Added:</strong> 版本新增：用 <tt class="docutils literal"><span class="pre">..versionadded::</span></tt> 指令来标识新增功能或配置选项，这样用户才能知道此选项适用的最低版本。</li>
<li><strong>Version Changed:</strong> 版本变更：用 <tt class="docutils literal"><span class="pre">..</span> <span class="pre">versionchanged::</span></tt> 指令标识用法或配置选项的变更。</li>
<li><strong>Deprecated:</strong> 已过时：用 <tt class="docutils literal"><span class="pre">..</span> <span class="pre">deprecated::</span></tt> 指令标识不再推荐或将被移除的 CLI 用法、功能、或配置选项。</li>
<li><strong>Topic:</strong> 论题：用 <tt class="docutils literal"><span class="pre">..</span> <span class="pre">topic::</span></tt> 指令来封装位于文档主体之外的文本。详情见 <a class="reference external" href="http://docutils.sourceforge.net/docs/ref/rst/directives.html#topic">topic 指令</a>。</li>
</ol>
</div>
<div class="section" id="toc">
<h3>TOC 和超链接<a class="headerlink" href="#toc" title="Permalink to this headline">¶</a></h3>
<p>所有文档都必须被链接到其他文档或列表内，否则构建时会被警告。</p>
<p>Ceph 项目采用 <tt class="docutils literal"><span class="pre">..</span> <span class="pre">toctree::</span></tt> 指令（详情见 <a class="reference external" href="http://sphinx-doc.org/markup/toctree.html">TOC 树</a>）。渲染时，最好用 <tt class="docutils literal"><span class="pre">:maxdepth:</span></tt> 参数把 TOC 修饰得简洁些。</p>
<p>链接目标是个惟一标识符（如 <tt class="docutils literal"><span class="pre">..</span> <span class="pre">_unique-target-id:</span></tt> ）、而且某一引用明确引用了它（如 <tt class="docutils literal"><span class="pre">:ref:</span> <span class="pre">`uniq-target-id`</span></tt> ），这时应该优先用 <tt class="docutils literal"><span class="pre">:ref:</span></tt> 语法。这样，如果源文件位置或文档结构变更之后链接仍然有效，详情见<a class="reference external" href="http://sphinx-doc.org/markup/inline.html#ref-role">交叉引用任意位置</a>。</p>
<p>Ceph 文档内的链接可以这样写：反引号（重音符号）、之后跟着链接文本、另一个反引号、最后是下划线； Sphinx 允许你内联链接目标。然而，我们喜欢这样用：在文档底部加 <tt class="docutils literal"><span class="pre">..</span> <span class="pre">_Link</span> <span class="pre">Text:</span> <span class="pre">../path</span></tt> ，因为这样的写法在命令行下可读性好。</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../intro/">Ceph 简介</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../hardware-recommendations/">硬件推荐</a></li>
<li class="toctree-l2"><a class="reference internal" href="../os-recommendations/">操作系统推荐</a></li>
<li class="toctree-l2"><a class="reference internal" href="../get-involved/">加入 Ceph 社区！</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">贡献 Ceph 文档</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">如何贡献</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id2">获取源代码</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3">进入分支</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4">开始更改</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5">构建文档源码</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#id6">构建源码（首次）</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#id7">提交变更</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id8">推送变更</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id9">发出接收请求</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id10">通知相关人员</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id11">文档风格手册</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id12">标题</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id13">正文</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id14">段落分级标记</a></li>
<li class="toctree-l4"><a class="reference internal" href="#toc">TOC 和超链接</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../">安装（快速）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install/">安装（手动）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rados/">Ceph 存储集群</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cephfs/">Ceph 文件系统</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rbd/rbd/">Ceph 块设备</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../radosgw/">Ceph 对象网关</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/">API 文档</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../architecture/">体系结构</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev/">开发文档</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release-notes/">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../releases/">Ceph 版本</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary/">Ceph 术语</a></li>
</ul>


<!-- ugly kludge to make genindex look like it's part of the toc -->
<ul style="margin-top: -10px"><li class="toctree-l1"><a class="reference internal" href="../../genindex/">Index</a></li></ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search/" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex/" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../" title="安装（快速）"
             >next</a> |</li>
        <li class="right" >
          <a href="../get-involved/" title="加入 Ceph 社区！"
             >previous</a> |</li>
        <li><a href="../../">Ceph Documentation</a> &raquo;</li>
          <li><a href="../intro/" >Ceph 简介</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2010-2014, Inktank Storage, Inc. and contributors. Licensed under Creative Commons BY-SA.
    </div>
  </body>
</html>