
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>OSD 配置参考 &mdash; Ceph Documentation</title>
    
    <link rel="stylesheet" href="../../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     'dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="top" title="Ceph Documentation" href="../../../" />
    <link rel="up" title="配置" href="../" />
    <link rel="next" title="filestore 配置参考" href="../filestore-config-ref/" />
    <link rel="prev" title="监视器与 OSD 交互的配置" href="../mon-osd-interaction/" />
    <script type="text/javascript" src="http://ayni.ceph.com/public/js/ceph.js"></script>

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex/" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../filestore-config-ref/" title="filestore 配置参考"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../mon-osd-interaction/" title="监视器与 OSD 交互的配置"
             accesskey="P">previous</a> |</li>
        <li><a href="../../../">Ceph Documentation</a> &raquo;</li>
          <li><a href="../../" >Ceph 存储集群</a> &raquo;</li>
          <li><a href="../" accesskey="U">配置</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="osd">
<h1>OSD 配置参考<a class="headerlink" href="#osd" title="Permalink to this headline">¶</a></h1>
<p id="index-0">你可以通过配置文件调整 OSD ，但靠默认值和极少的配置 OSD 守护进程就能运行。最简 OSD 配置需设置 <tt class="docutils literal"><span class="pre">osd</span> <span class="pre">journal</span> <span class="pre">size</span></tt> 和 <tt class="docutils literal"><span class="pre">host</span></tt> ，其他几乎都能用默认值。</p>
<p>Ceph 的 OSD 守护进程用递增的数字作标识，按惯例以 <tt class="docutils literal"><span class="pre">0</span></tt> 开始，如下：</p>
<div class="highlight-python"><pre>osd.0
osd.1
osd.2</pre>
</div>
<p>在配置文件里， <tt class="docutils literal"><span class="pre">[osd]</span></tt> 段下的配置适用于所有 OSD ；要添加针对特定 OSD 的选项（如 <tt class="docutils literal"><span class="pre">host</span></tt> ），把它放到那个 OSD 段下即可，如：</p>
<div class="highlight-ini"><div class="highlight"><pre><span class="k">[osd]</span>
        <span class="na">osd journal size</span> <span class="o">=</span> <span class="s">1024</span>

<span class="k">[osd.0]</span>
        <span class="na">host</span> <span class="o">=</span> <span class="s">osd-host-a</span>

<span class="k">[osd.1]</span>
        <span class="na">host</span> <span class="o">=</span> <span class="s">osd-host-b</span>
</pre></div>
</div>
<div class="section" id="index-1">
<span id="id1"></span><h2>常规配置<a class="headerlink" href="#index-1" title="Permalink to this headline">¶</a></h2>
<p>下列选项可配置一 OSD 的唯一标识符、以及数据和日志的路径。 Ceph 部署脚本通常会自动生成 UUID 。我们<strong>不建议</strong>更改数据和日志的默认路径，因为这样会增加后续的排障难度。</p>
<p>日志尺寸应该大于期望的驱动器速度和 <tt class="docutils literal"><span class="pre">filestore</span> <span class="pre">max</span> <span class="pre">sync</span> <span class="pre">interval</span></tt> 之乘积的两倍；最常见的方法是为日志驱动器（通常是 SSD ）分区并挂载好，这样 Ceph 就可以用整个分区做日志。</p>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">uuid</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">OSD 的全局唯一标识符（ UUID ）。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">UUID</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body">The UUID.</td>
</tr>
<tr class="field-even field"><th class="field-name">备注:</th><td class="field-body"><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">uuid</span></tt> 适用于单个 OSD ， <tt class="docutils literal"><span class="pre">fsid</span></tt> 适用于整个集群。</td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">data</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">OSD 数据存储位置，你得创建并把数据盘挂载到其下。我们不推荐更改默认值。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">String</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">/var/lib/ceph/osd/$cluster-$id</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">max</span> <span class="pre">write</span> <span class="pre">size</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">一次写入的最大尺寸，MB。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">32-bit Integer</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">90</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">client</span> <span class="pre">message</span> <span class="pre">size</span> <span class="pre">cap</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">内存里允许的最大客户端数据消息。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">64-bit Integer Unsigned</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body">默认为 500MB 。 <tt class="docutils literal"><span class="pre">500*1024L*1024L</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">class</span> <span class="pre">dir</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">RADOS 类插件的路径。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">String</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">$libdir/rados-classes</span></tt></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="index-2">
<span id="id2"></span><h2>文件系统选项<a class="headerlink" href="#index-2" title="Permalink to this headline">¶</a></h2>
<p>Ceph 可自动创建并挂载所需的文件系统。</p>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">mkfs</span> <span class="pre">options</span> <span class="pre">{fs-type}</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">为 OSD 新建 {fs-type} 类型的文件系统时使用的选项。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">String</td>
</tr>
<tr class="field-odd field"><th class="field-name">xfs 默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">-f</span> <span class="pre">-i</span> <span class="pre">2048</span></tt></td>
</tr>
<tr class="field-even field"><th class="field-name">其余文件系统默认值:</th><td class="field-body">{empty string}</td>
</tr>
<tr class="field-odd field"><th class="field-name">实例:</th><td class="field-body"><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">mkfs</span> <span class="pre">options</span> <span class="pre">xfs</span> <span class="pre">=</span> <span class="pre">-f</span> <span class="pre">-d</span> <span class="pre">agcount=24</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">mount</span> <span class="pre">options</span> <span class="pre">{fs-type}</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">挂载 {fs-type} 类型的文件系统作为 OSD 数据目录时所用的选项。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">String</td>
</tr>
<tr class="field-odd field"><th class="field-name">xfs 默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">rw,noatime,inode64</span></tt></td>
</tr>
<tr class="field-even field"><th class="field-name">其余文件系统默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">rw,</span> <span class="pre">noatime</span></tt></td>
</tr>
<tr class="field-odd field"><th class="field-name">实例:</th><td class="field-body"><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">mount</span> <span class="pre">options</span> <span class="pre">xfs</span> <span class="pre">=</span> <span class="pre">rw,</span> <span class="pre">noatime,</span> <span class="pre">inode64,</span> <span class="pre">logbufs=8</span></tt></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="index-3">
<span id="id3"></span><h2>日志选项<a class="headerlink" href="#index-3" title="Permalink to this headline">¶</a></h2>
<p>默认情况下， Ceph 觉得你会把 OSD 日志存储于下列路径：</p>
<div class="highlight-python"><pre>/var/lib/ceph/osd/$cluster-$id/journal</pre>
</div>
<p>未做性能优化时， Ceph 会把日志存储在与 OSD 数据相同的硬盘上。追求高性能的 OSD 可用单独的硬盘存储日志数据，如固态硬盘能提供高性能日志。</p>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">journal</span> <span class="pre">size</span></tt> 默认值是 0 ，所以你得在 <tt class="docutils literal"><span class="pre">ceph.conf</span></tt> 里设置。日志尺寸应该是 <tt class="docutils literal"><span class="pre">filestore</span> <span class="pre">max</span> <span class="pre">sync</span> <span class="pre">interval</span></tt> 与期望吞吐量的乘积再乘以 2 。</p>
<div class="highlight-python"><pre>osd journal size = {2 * (expected throughput * filestore max sync interval)}</pre>
</div>
<p>期望吞吐量应考虑期望的硬盘吞吐量（即持续数据传输速率）、和网络吞吐量，例如一个 7200 转硬盘的速度大致是 100MB/s 。硬盘和网络吞吐量中较小的（ <tt class="docutils literal"><span class="pre">min()</span></tt> ）一个是相对合理的吞吐量，有的用户则以 10GB 日志尺寸起步，例如：</p>
<div class="highlight-python"><pre>osd journal size = 10000</pre>
</div>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">journal</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">OSD 日志路径，可以是一个文件或块设备（ SSD 的一个分区）的路径。如果是文件，要先创建相应目录。我们建议用 <tt class="docutils literal"><span class="pre">osd</span> <span class="pre">data</span></tt> 以外的独立驱动器。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">String</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">/var/lib/ceph/osd/$cluster-$id/journal</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">journal</span> <span class="pre">size</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">日志尺寸（ MB ）。如果是 0 且日志文件是块设备，它会使用整个块设备。从 v0.54 起，如果日志文件是块设备，这个选项会被忽略，且使用整个块设备。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">32-bit Integer</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">5120</span></tt></td>
</tr>
<tr class="field-even field"><th class="field-name">推荐值:</th><td class="field-body">最少 1G ，应该是期望的驱动器速度和 <tt class="docutils literal"><span class="pre">filestore</span> <span class="pre">max</span> <span class="pre">sync</span> <span class="pre">interval</span></tt> 的乘积。</td>
</tr>
</tbody>
</table>
<p>详情见<a class="reference external" href="../journal-ref">日志配置参考</a>。</p>
</div>
<div class="section" id="id4">
<h2>监视器和 OSD 的交互<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>OSD 周期性地相互检查心跳并报告给监视器。 Ceph 默认配置可满足多数情况，但是如果你的网络延时大，就得用较长间隔。关于心跳的讨论参见<a class="reference external" href="../mon-osd-interaction">监视器与 OSD 交互的配置</a>。</p>
</div>
<div class="section" id="id5">
<h2>数据归置<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<p>详情见<a class="reference external" href="../pool-pg-config-ref">存储池和归置组配置参考</a>。</p>
</div>
<div class="section" id="index-4">
<span id="id6"></span><h2>洗刷<a class="headerlink" href="#index-4" title="Permalink to this headline">¶</a></h2>
<p>除了为对象复制多个副本外， Ceph 还要洗刷归置组以确保数据完整性。这种洗刷类似对象存储层的 <tt class="docutils literal"><span class="pre">fsck</span></tt> ，对每个归置组， Ceph 生成一个所有对象的目录，并比对每个主对象及其副本以确保没有对象丢失或错配。轻微洗刷（每天）检查对象尺寸和属性，深层洗刷（每周）会读出数据并用校验和方法确认数据完整性。</p>
<p>洗刷对维护数据完整性很重要，但会影响性能；你可以用下列选项来增加或减少洗刷操作。</p>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">max</span> <span class="pre">scrubs</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">一 OSD 的最大并发洗刷操作数。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">32-bit Int</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">1</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">scrub</span> <span class="pre">begin</span> <span class="pre">hour</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">被调度的洗刷操作在一天中可以运行的时间下限。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">0 到 24 之间的整数</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">0</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">scrub</span> <span class="pre">end</span> <span class="pre">hour</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">被调度的洗刷操作在一天中可以运行的时间上限。本选项与 <tt class="docutils literal"><span class="pre">osd</span> <span class="pre">scrub</span> <span class="pre">begin</span> <span class="pre">hour</span></tt> 一起定义了一个时间窗口，在此期间可以进行洗刷操作。但是，在某个归置组的洗刷间隔超过 <tt class="docutils literal"><span class="pre">osd</span> <span class="pre">scrub</span> <span class="pre">max</span> <span class="pre">interval</span></tt> 时，不管这个时间窗口是否合适都会执行。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">0 到 24 之间的整数</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">24</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">scrub</span> <span class="pre">thread</span> <span class="pre">timeout</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">洗刷线程最大死亡时值。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">32-bit Integer</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">60</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">scrub</span> <span class="pre">finalize</span> <span class="pre">thread</span> <span class="pre">timeout</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">洗刷终结线程最大超时值。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">32-bit Integer</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">60*10</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">scrub</span> <span class="pre">load</span> <span class="pre">threshold</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">最大负载，当前系统负载（ <tt class="docutils literal"><span class="pre">getloadavg()</span></tt> 所定义的）高于此值时 Ceph 不会洗刷。默认 <tt class="docutils literal"><span class="pre">0.5</span></tt> 。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">Float</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">0.5</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">scrub</span> <span class="pre">min</span> <span class="pre">interval</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">集群负载低的时候，洗刷的最大间隔时间，秒。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">Float</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body">每天一次。 <tt class="docutils literal"><span class="pre">60*60*24</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">scrub</span> <span class="pre">max</span> <span class="pre">interval</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">不论集群负载如何，都要进行洗刷的时间间隔。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">Float</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body">每周一次。 <tt class="docutils literal"><span class="pre">7*60*60*24</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">deep</span> <span class="pre">scrub</span> <span class="pre">interval</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">深层洗刷的间隔（完整地读所有数据）。 <tt class="docutils literal"><span class="pre">osd</span> <span class="pre">scrub</span> <span class="pre">load</span> <span class="pre">threshold</span></tt> 不会影响此选项。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">Float</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body">每周一次。 <tt class="docutils literal"><span class="pre">60*60*24*7</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">scrub</span> <span class="pre">interval</span> <span class="pre">randomize</span> <span class="pre">ratio</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">在给某一归置组调度下一个洗刷作业时，给 <tt class="docutils literal"><span class="pre">osd</span> <span class="pre">scrub</span> <span class="pre">min</span> <span class="pre">interval</span></tt> 增加个随机延时，这个延时是个小于 <tt class="docutils literal"><span class="pre">osd</span> <span class="pre">scrub</span> <span class="pre">min</span> <span class="pre">interval</span></tt> * <tt class="docutils literal"><span class="pre">osd</span> <span class="pre">scrub</span> <span class="pre">interval</span> <span class="pre">randomized</span> <span class="pre">ratio</span></tt> 的随机值。所以在实践中，这个默认设置会把洗刷操作随机地散布到允许的时间窗口内，即 <tt class="docutils literal"><span class="pre">[1,</span> <span class="pre">1.5]</span></tt> * <tt class="docutils literal"><span class="pre">osd</span> <span class="pre">scrub</span> <span class="pre">min</span> <span class="pre">interval</span></tt> 。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">Float</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">0.5</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">deep</span> <span class="pre">scrub</span> <span class="pre">stride</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">深层洗刷时的读取尺寸。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">32-bit Integer</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body">512 KB. <tt class="docutils literal"><span class="pre">524288</span></tt></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="index-5">
<span id="id7"></span><h2>操作数<a class="headerlink" href="#index-5" title="Permalink to this headline">¶</a></h2>
<p>操作数选项允许你设置用于服务的线程数，如果把 <tt class="docutils literal"><span class="pre">osd</span> <span class="pre">op</span> <span class="pre">threads</span></tt> 设置为 <tt class="docutils literal"><span class="pre">0</span></tt> 就禁用了多线程。默认情况下， Ceph 用 30 秒超时和 30 秒抗议时间来把握 2 个线程的运行情况。你可以调整客户端操作和恢复操作的优先程度来优化恢复期间的性能。</p>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">op</span> <span class="pre">threads</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">OSD 操作线程数， <tt class="docutils literal"><span class="pre">0</span></tt> 为禁用。增大数量可以增加请求处理速度。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">32-bit Integer</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">2</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">client</span> <span class="pre">op</span> <span class="pre">priority</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">设置客户端操作优先级，它相对于 <tt class="docutils literal"><span class="pre">osd</span> <span class="pre">recovery</span> <span class="pre">op</span> <span class="pre">priority</span></tt> 。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">32-bit Integer</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">63</span></tt></td>
</tr>
<tr class="field-even field"><th class="field-name">有效范围:</th><td class="field-body">1-63</td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">recovery</span> <span class="pre">op</span> <span class="pre">priority</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">设置恢复优先级，其值相对于 <tt class="docutils literal"><span class="pre">osd</span> <span class="pre">client</span> <span class="pre">op</span> <span class="pre">priority</span></tt> 。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">32-bit Integer</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">10</span></tt></td>
</tr>
<tr class="field-even field"><th class="field-name">有效范围:</th><td class="field-body">1-63</td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">op</span> <span class="pre">thread</span> <span class="pre">timeout</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">OSD 线程超时秒数。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">32-bit Integer</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">30</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">op</span> <span class="pre">complaint</span> <span class="pre">time</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">一个操作进行多久后开始抱怨。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">Float</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">30</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">disk</span> <span class="pre">threads</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">硬盘线程数，用于在后台执行磁盘密集型操作，像数据洗刷和快照修复。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">32-bit Integer</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">1</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">disk</span> <span class="pre">thread</span> <span class="pre">ioprio</span> <span class="pre">class</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">警告：只有 <tt class="docutils literal"><span class="pre">osd</span> <span class="pre">disk</span> <span class="pre">thread</span> <span class="pre">ioprio</span> <span class="pre">class</span></tt> 和 <tt class="docutils literal"><span class="pre">osd</span> <span class="pre">disk</span> <span class="pre">thread</span> <span class="pre">ioprio</span> <span class="pre">priority</span></tt> 同时改为非默认值时此配置才生效。 OSD 用 ioprio_set(2) 为磁盘线程设置 I/O 调度分类（ <tt class="docutils literal"><span class="pre">class</span></tt> ），当前支持 <tt class="docutils literal"><span class="pre">idle</span></tt> 、 <tt class="docutils literal"><span class="pre">be</span></tt> 或 <tt class="docutils literal"><span class="pre">rt</span></tt> 。 <tt class="docutils literal"><span class="pre">idle</span></tt> 类意味着磁盘线程的优先级在 OSD 中是最低的，适合需延缓洗刷操作的情形，如 OSD 正忙于处理客户端操作。 <tt class="docutils literal"><span class="pre">be</span></tt> 是默认值，将设置与其它 OSD 线程相同的优先级。 <tt class="docutils literal"><span class="pre">rt</span></tt> 意为磁盘线程的优先级将高于其它任何 OSD 线程；适用于急需洗刷、并且即使牺牲客户端操作也要进行时。注：只能与 Linux 内核的 CFQ 调度器配合使用。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">String</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body">空字符串</td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">disk</span> <span class="pre">thread</span> <span class="pre">ioprio</span> <span class="pre">priority</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">警告：只有 <tt class="docutils literal"><span class="pre">osd</span> <span class="pre">disk</span> <span class="pre">thread</span> <span class="pre">ioprio</span> <span class="pre">class</span></tt> 和 <tt class="docutils literal"><span class="pre">osd</span> <span class="pre">disk</span> <span class="pre">thread</span> <span class="pre">ioprio</span> <span class="pre">priority</span></tt> 同时改为非默认值时此配置才生效。它通过 ioprio_set(2) 设置磁盘线程的 I/O 调度优先级（ <tt class="docutils literal"><span class="pre">priority</span></tt> ），优先级从最高的 0 到最低的 7 。如果某主机上的所有 OSD 都在 <tt class="docutils literal"><span class="pre">idle</span></tt> 类中竞争 I/O 资源（即控制器拥塞了），那么你就可以用此选项把某 OSD 的磁盘线程优先级调低为 7 ，其它优先级为 0 的 OSD 就有可能洗刷得快一点。注：只能与 Linux 内核的 CFQ 调度器配合使用。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">0 到 7 间的整数， -1 禁用此功能。</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">-1</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">op</span> <span class="pre">history</span> <span class="pre">size</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">要跟踪的最大已完成操作数量。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">32-bit Unsigned Integer</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">20</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">op</span> <span class="pre">history</span> <span class="pre">duration</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">要跟踪的最老已完成操作。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">32-bit Unsigned Integer</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">600</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">op</span> <span class="pre">log</span> <span class="pre">threshold</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">一次显示多少操作日志。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">32-bit Integer</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">5</span></tt></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="index-6">
<span id="id8"></span><h2>回填<a class="headerlink" href="#index-6" title="Permalink to this headline">¶</a></h2>
<p>当集群新增或移除 OSD 时，按照 CRUSH 算法应该重新均衡集群，它会把一些归置组移出或移入多个 OSD 以回到均衡状态。归置组和对象的迁移会导致集群运营性能显著降低，为维持运营性能， Ceph 用 backfilling 来执行此迁移，它可以使得 Ceph 的回填操作优先级低于用户读写请求。</p>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">max</span> <span class="pre">backfills</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">单个 OSD 允许的最大回填操作数。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">64-bit Unsigned Integer</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">10</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">backfill</span> <span class="pre">scan</span> <span class="pre">min</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">集群负载低时，回填操作时扫描间隔。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">32-bit Integer</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">64</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">backfill</span> <span class="pre">scan</span> <span class="pre">max</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">回填操作时最大扫描间隔。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">32-bit Integer</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">512</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">backfill</span> <span class="pre">full</span> <span class="pre">ratio</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">OSD 的占满率达到多少时拒绝接受回填请求。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">Float</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">0.85</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">backfill</span> <span class="pre">retry</span> <span class="pre">interval</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">重试回填请求前等待秒数。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">Double</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">10.0</span></tt></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="index-7">
<span id="id9"></span><h2>OSD 运行图<a class="headerlink" href="#index-7" title="Permalink to this headline">¶</a></h2>
<p>OSD 运行图反映集群中运行的 OSD 守护进程，斗转星移，图元增加。 Ceph 用一些选项来确保 OSD 运行图增大时仍运行良好。</p>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">map</span> <span class="pre">dedup</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">允许删除 OSD 图里的重复项。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">Boolean</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">true</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">map</span> <span class="pre">cache</span> <span class="pre">size</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">缓存的 OSD 图个数。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">32-bit Integer</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">500</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">map</span> <span class="pre">cache</span> <span class="pre">bl</span> <span class="pre">size</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">OSD 进程中，驻留内存的 OSD 图缓存尺寸。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">32-bit Integer</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">50</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">map</span> <span class="pre">cache</span> <span class="pre">bl</span> <span class="pre">inc</span> <span class="pre">size</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">OSD 进程中，驻留内存的 OSD 图缓存增量尺寸。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">32-bit Integer</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">100</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">map</span> <span class="pre">message</span> <span class="pre">max</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">每个  MOSDMap 图消息允许的最大条目数量。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">32-bit Integer</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">100</span></tt></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="index-8">
<span id="id10"></span><h2>恢复<a class="headerlink" href="#index-8" title="Permalink to this headline">¶</a></h2>
<p>当集群启动、或某 OSD 守护进程崩溃后重启时，此 OSD 开始与其它 OSD 们建立连接，这样才能正常工作。详情见<a class="reference external" href="../../operations/monitoring-osd-pg#peering">监控 OSD 和归置组</a>。</p>
<p>如果某 OSD 崩溃并重生，通常会落后于其他 OSD ，也就是没有同归置组内最新版本的对象。这时， OSD 守护进程进入恢复模式并检索最新数据副本，并更新运行图。根据 OSD 挂的时间长短， OSD 的对象和归置组可能落后得厉害，另外，如果挂的是一个失效域（如一个机柜），多个 OSD 会同时重生，这样恢复时间更长、更耗资源。</p>
<p>为保持运营性能， Ceph 进行恢复时会限制恢复请求数、线程数、对象块尺寸，这样在降级状态下也能保持良好的性能。</p>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">recovery</span> <span class="pre">delay</span> <span class="pre">start</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">对等关系建立完毕后， Ceph 开始对象恢复前等待的时间（秒）。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">Float</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">0</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">recovery</span> <span class="pre">max</span> <span class="pre">active</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">每个 OSD 一次处理的活跃恢复请求数量，增大此值能加速恢复，但它们会增加集群负载。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">32-bit Integer</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">15</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">recovery</span> <span class="pre">max</span> <span class="pre">chunk</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">一次推送的数据块的最大尺寸。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">64-bit Integer Unsigned</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">8</span> <span class="pre">&lt;&lt;</span> <span class="pre">20</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">recovery</span> <span class="pre">threads</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">数据恢复时的线程数。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">32-bit Integer</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">1</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">recovery</span> <span class="pre">thread</span> <span class="pre">timeout</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">恢复线程最大死亡时值。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">32-bit Integer</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">30</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">recover</span> <span class="pre">clone</span> <span class="pre">overlap</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">在数据恢复期间保留重叠副本。应该总是 <tt class="docutils literal"><span class="pre">true</span></tt> 。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">Boolean</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">true</span></tt></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id11">
<h2>杂项<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h2>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">snap</span> <span class="pre">trim</span> <span class="pre">thread</span> <span class="pre">timeout</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">快照修复线程最大死亡时值。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">32-bit Integer</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">60*60*1</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">backlog</span> <span class="pre">thread</span> <span class="pre">timeout</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">积压线程最大死亡时值。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">32-bit Integer</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">60*60*1</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">default</span> <span class="pre">notify</span> <span class="pre">timeout</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">OSD 默认通告超时，秒。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">32-bit Integer Unsigned</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">30</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">check</span> <span class="pre">for</span> <span class="pre">log</span> <span class="pre">corruption</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">根据日志文件查找数据损坏，会耗费大量计算时间。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">Boolean</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">false</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">remove</span> <span class="pre">thread</span> <span class="pre">timeout</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">OSD 删除线程的最大死亡时值。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">32-bit Integer</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">60*60</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">command</span> <span class="pre">thread</span> <span class="pre">timeout</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">命令线程最大超时值。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">32-bit Integer</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">10*60</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">command</span> <span class="pre">max</span> <span class="pre">records</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">限制返回的丢失对象数量。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">32-bit Integer</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">256</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">auto</span> <span class="pre">upgrade</span> <span class="pre">tmap</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">在旧对象上给 <tt class="docutils literal"><span class="pre">omap</span></tt> 使用 <tt class="docutils literal"><span class="pre">tmap</span></tt> 。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">Boolean</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">true</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">tmapput</span> <span class="pre">sets</span> <span class="pre">users</span> <span class="pre">tmap</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">只在调试时使用 <tt class="docutils literal"><span class="pre">tmap</span></tt> 。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">Boolean</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">false</span></tt></td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">osd</span> <span class="pre">preserve</span> <span class="pre">trimmed</span> <span class="pre">log</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">描述:</th><td class="field-body">保留本该修剪掉的日志文件，但是会占用更多磁盘空间。</td>
</tr>
<tr class="field-even field"><th class="field-name">类型:</th><td class="field-body">Boolean</td>
</tr>
<tr class="field-odd field"><th class="field-name">默认值:</th><td class="field-body"><tt class="docutils literal"><span class="pre">false</span></tt></td>
</tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../">
              <img class="logo" src="../../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../../">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../start/intro/">Ceph 简介</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../start/">安装（快速）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../install/">安装（手动）</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../">Ceph 存储集群</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../">配置</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../filesystem-recommendations/">硬盘和文件系统</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ceph-conf/">配置 Ceph</a></li>
<li class="toctree-l3"><a class="reference internal" href="../network-config-ref/">网络选项</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auth-config-ref/">认证选项</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mon-config-ref/">监视器选项</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mon-osd-interaction/">心跳选项</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="">OSD 选项</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#index-1">常规配置</a></li>
<li class="toctree-l4"><a class="reference internal" href="#index-2">文件系统选项</a></li>
<li class="toctree-l4"><a class="reference internal" href="#index-3">日志选项</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4">监视器和 OSD 的交互</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5">数据归置</a></li>
<li class="toctree-l4"><a class="reference internal" href="#index-4">洗刷</a></li>
<li class="toctree-l4"><a class="reference internal" href="#index-5">操作数</a></li>
<li class="toctree-l4"><a class="reference internal" href="#index-6">回填</a></li>
<li class="toctree-l4"><a class="reference internal" href="#index-7">OSD 运行图</a></li>
<li class="toctree-l4"><a class="reference internal" href="#index-8">恢复</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id11">杂项</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../filestore-config-ref/">filestore 选项</a></li>
<li class="toctree-l3"><a class="reference internal" href="../keyvaluestore-config-ref/">键/值存储选项</a></li>
<li class="toctree-l3"><a class="reference internal" href="../journal-ref/">日志选项</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pool-pg-config-ref/">存储池、归置组和 CRUSH 选项</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ms-ref/">消息传递选项</a></li>
<li class="toctree-l3"><a class="reference internal" href="../general-config-ref/">常规选项</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../deployment/">部署</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../operations/">运维</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/">手册页</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../troubleshooting/">故障排除</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/">APIs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../cephfs/">Ceph 文件系统</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rbd/rbd/">Ceph 块设备</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../radosgw/">Ceph 对象网关</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/">API 文档</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../architecture/">体系结构</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dev/">开发文档</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../release-notes/">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../releases/">Ceph 版本</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary/">Ceph 术语</a></li>
</ul>


<!-- ugly kludge to make genindex look like it's part of the toc -->
<ul style="margin-top: -10px"><li class="toctree-l1"><a class="reference internal" href="../../../genindex/">Index</a></li></ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../search/" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex/" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../filestore-config-ref/" title="filestore 配置参考"
             >next</a> |</li>
        <li class="right" >
          <a href="../mon-osd-interaction/" title="监视器与 OSD 交互的配置"
             >previous</a> |</li>
        <li><a href="../../../">Ceph Documentation</a> &raquo;</li>
          <li><a href="../../" >Ceph 存储集群</a> &raquo;</li>
          <li><a href="../" >配置</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2010-2014, Inktank Storage, Inc. and contributors. Licensed under Creative Commons BY-SA.
    </div>
  </body>
</html>